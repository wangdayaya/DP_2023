# 前文
最近的一段时间一直在使用大模型做 `txt2sql` 相关的产品，结合自己的实际项目经验，和其他高人的经验，现写一篇总结来记录一下如何使用大模型来做好一个可以上线的产品。


使用大模型的最重要的一步就是编写好的提示词 `prompt` ，但是 prompt 既容易被`低估`也容易被`高估`。被低估是因为设计良好的提示词可以显著提升效果。被高估是因为即使是基于提示的应用也需要大量的工程工作才能使其发挥作用。下面我会介绍在编写 prompt 的时候，有助于提升性能的技术点。

# 明确定义助手功能
一般我们会给大模型定义一个`助手角色基调`，简要明确告诉它需要做的任务是什么即可，只要框定助手要干的事情边界，不至于跑偏即可。比如可以告诉大模型是一个精通撩妹的高手。

# 提出详细的要求
我们在这里可以详细描述助手具体要干的事情，以及需要注意的点。内容一定要`精简不啰嗦`，要点一定要`分步罗列清楚`，前后文的描述中`不允许有冲突`的地方，否则很容易在推理阶段让大模型不知所措。简要明了的任务要求描述，能让大模型更好的执行任务，减少误差或者歧义。例如：你想撩妹但是你无房无车无存款等要求。

# 使用 RAG 
如果我们有可以获取的`外部知识`也可以加入到提示词中，这里有助于模型减少出现幻觉的可能，让它的回答能更加真实可靠有依据。比如我们现在有一个《如何撩妹.txt》 ，我们放入向量库，在针对不同问题的时候召回相应的 doc 喂给大模型，提升其撩妹的能力。有外部的知识可用，这比大模型空想瞎想如何撩妹靠谱的多。

需要注意的是单纯使用`向量召回`可能效果很差，我们可以结合`传统的 BM25 `的方式进行关键词的 doc 召回，最后得到的 doc 相对来说会有用的多。在大多数情况下，混合搜索是非常有效的：关键词搜索用于明显关键词的匹配，而向量召回用于同义词、上位词和拼写错误，以及多模态的信息召回。


# 做好 few-shot
一般我们会给大模型一些例子，这些例子要有代表性，基本上能把你的任务中的常见情况和特殊情况都覆盖即可，一般 5 个左右足够了，复杂任务可以适当增多。好的例子能大幅度提升大模型对于任务的理解和推理能力。

# 使用思维链 CoT 
如果你还不知道什么是`思维链`，可以先看[这里](https://blog.csdn.net/Julialove102123/article/details/135499567)了解一下。我们在遇到推理等复杂任务的时候，可以在给出例子中引导大模型一步一步去抽丝剥茧理解问题并解决问题，例如下面让大模型进行算数解答的问题，如果是常规的左边的方式直接给出答案，那就很有可能是错的。如果像右边你能在给出的例子中详细阐述解题思路，最后模型也会在推理的时候一步一步给出思考过程，得到的答案比前一种方式对的可能性更高。


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b75ed5c9f4194756aedf70aecacddb38~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=891&h=439&s=184924&e=png&b=fcfcfc)

# 输入和输出结构化
一般我们的输入都是夹在 prompt 中的进行提问的，而输出的内容我们需要提取有效的信息，我一般都有自己的特殊符号，定义了合适的输入和输出格式，有利于我们生成美观的 prompt 和获取有效的信息。

# 尽量做好一件事

随着业务要求的增多，有的人巴不得想让大模型一次能干好多事情，处理更多边缘情况，复杂性就会增加，更多的指令，更多步骤推理，再加上几十个例子，以至于最后 prompt 又臭又长，这种是最忌讳的，出错的可能性极大。还不如拆解一下，每次写的 prompt 能干好一件事情。

# 实战

我们上面的理论也讲了很多，下面就让我们结合上面的知识实战一把。下面的例子比较简单，大家理解要领即可。


```
<定义角色功能和要求>
你是一名精通撩妹的高手，擅长用幽默、浪漫的话语和机智的对话打动女性。
你的目标是通过不花钱的方式，在一周之内找到一位25岁左右的富婆美女。
你可以参考一本《如何撩妹》的书籍内容来帮助你实现这个目标。

<输入的参数、内容、其他要求>
女孩的名字：{name} 
女孩的特征：{traits} 
要求： 
1. 不能花钱。 
2. 在一周内找到25岁左右的富婆美女。 
3. 根据《如何撩妹》的书籍内容给出撩妹的策略及话术。

<输出内容及格式>
请按照下面的格式输出相关内容：
撩妹策略： {strategy} 
撩妹话语： {pickup_line}

例子1

输入：
女孩的名字：美玲 
女孩的特征：25岁，富婆，喜欢艺术品，热爱社交 
要求： 
1. 不能花钱。 
2. 在一周内找到25岁左右的富婆美女。 
3. 根据《如何撩妹》的书籍内容给出撩妹的策略及话术。

输出:
撩妹策略：<这里其实就是思维链的过程，教你如何具体实施的步骤>
1. 从《如何撩妹》书中提取关于喜欢艺术品和社交技巧的美女的内容。
2. 在社交媒体上找到美玲，并关注她的动态，尤其是她参加的艺术展览和社交活动。
3. 在她经常出现的艺术展览和社交场合中偶遇，展示出对艺术品的浓厚兴趣。
4. 使用幽默和机智的对话技巧，逐步引起她的注意和兴趣。

撩妹话语：<输出得到的话术>
美玲，你的艺术品收藏让我想起一句话：真正的艺术不仅仅是摆在展厅里的作品，而是懂得欣赏它的人。和你聊艺术，每一次都像是一场精彩的展览，让人流连忘返。


例子2

输入：
女孩的名字：莉莉 
女孩的特征：25岁，富婆，喜欢高尔夫，热爱健身 
要求： 
1. 不能花钱。 
2. 在一周内找到25岁左右的富婆美女。 
3. 根据《如何撩妹》的书籍内容给出撩妹的策略及话术。

输出：
撩妹策略：<这里其实就是思维链的过程，教你如何具体实施的步骤>
1. 从《如何撩妹》书中提取关于喜欢运动和健身的美女的内容。
2. 在高尔夫球场和健身房中寻找机会接近莉莉。
3. 主动参与她的健身或高尔夫活动，展示你的运动能力和健康生活方式。
4. 使用幽默和鼓励的话语，增进彼此的互动和了解。

撩妹话语：<输出得到的话术>
莉莉，你的挥杆动作真是优雅又有力量，每一次都让我觉得高尔夫不只是运动，更是一种艺术。我觉得，和你一起运动，不仅能锻炼身体，更能享受每一刻的美好时光。


```



# 参考
- LLMs 产品经验：https://baoyu.io/translations/llm/what-we-learned-from-a-year-of-building-with-llms-part-1?continueFlag=a4c248d0a04ed355aa259712cee47c87&s_channel=4&s_trans=1838133514_
- 思维链：https://blog.csdn.net/Julialove102123/article/details/135499567